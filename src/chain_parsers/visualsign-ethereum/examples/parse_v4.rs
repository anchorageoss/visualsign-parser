use visualsign_ethereum::protocols::uniswap::V4PoolManagerVisualizer;
use hex;
use serde_json;

fn main() {
    let visualizer = V4PoolManagerVisualizer;
    
    // Initialize Calldata (from v4_pool.rs tests)
    let init_calldata_str = concat!(
            "695c5bf5",
            "0000000000000000000000000000000000000001000000000000000000000000", // Currency0
            "0000000000000000000000000000000000000002000000000000000000000000", // Currency1
            "0000000000000000000000000000000000000000000000000000000000000bb8", // Fee
            "000000000000000000000000000000000000000000000000000000000000003c", // TickSpacing
            "0000000000000000000000000000000000000000000000000000000000000000", // Hooks
            "0000000000000000000000000100000000000000000000000000000000000000", // SqrtPriceX96
            "00000000000000000000000000000000000000000000000000000000000000e0", // Offset
            "0000000000000000000000000000000000000000000000000000000000000000"  // Length
    );
    let init_calldata = hex::decode(init_calldata_str).unwrap();
    
    println!("=== Initialize Visualization (JSON) ===");
    if let Some(field) = visualizer.visualize_tx_commands(&init_calldata, 11155111, None) {
        println!("{}", serde_json::to_string_pretty(&field).unwrap());
    } else {
        println!("Failed to visualize initialize");
    }

    // Swap Calldata (from v4_pool.rs tests)
    let swap_calldata_str = "f3cd914c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000bb8000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000";
    let swap_calldata = hex::decode(swap_calldata_str).unwrap();

    println!("\n=== Swap Visualization (JSON) ===");
    if let Some(field) = visualizer.visualize_tx_commands(&swap_calldata, 11155111, None) {
        println!("{}", serde_json::to_string_pretty(&field).unwrap());
    } else {
         println!("Failed to visualize swap");
    }
}
